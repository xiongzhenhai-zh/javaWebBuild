(function(t,R){var E,w,F;function h(){return O+P++}function G(){C||(C=x.find("a[commandName]"));C.each(function(){var c=a(this),l=a.trim(c.attr("commandName")).toLowerCase();"insertunorderedlist"!==l&&"insertorderedlist"!==l&&(g.queryCommandState(l)?c.addClass("wangEditor-btn-container-btn-selected"):c.removeClass("wangEditor-btn-container-btn-selected"))})}function H(){var c,l,d,r=b[0];I?(c=g.getSelection(),c.getRangeAt&&c.rangeCount&&(l=g.getSelection().getRangeAt(0),d=l.commonAncestorContainer)):
(l=g.selection.createRange(),d=l.parentElement());if(d&&(a.contains(r,d)||r===d))return p=d,l}function Q(){var c=b.html();k=[];k.push(c);n=0}function J(){var c=k.length,a=b.html();0<c&&a===k[n]||(k.push(a),20<=c&&k.shift(),c=k.length,n=c-1)}function L(c){return c.parent().is('div[contenteditable="true"]')?c:"body"===c[0].nodeName.toLowerCase()?b.children().last():c.is('div[contenteditable="true"]')?c.children().last():L(c.parent())}function M(c){c=a.trim(c.toLowerCase());return 0===c.indexOf("javascript:")?
!1:!0}function v(c,a,d,r){if(s){var f;if(s){var e;I?(e=g.getSelection(),e.removeAllRanges(),e.addRange(s)):(e=g.selection.createRange(),e.setEndPoint("EndToEnd",s),0===s.text.length?e.collapse(!1):e.setEndPoint("StartToStart",s),e.select())}try{f=g.queryCommandEnabled(a)}catch(S){f=!1}!0===f?g.execCommand(a,!1,d):(f=N[a])&&f(a,d);s=H();r&&r.call(b);G();K.find(".wangEditor-modal:visible").hide();y.is(":visible")&&y.hide();J()}c&&c.preventDefault()}if(t.jQuery){var g=t.document,a=t.jQuery,I="function"===
typeof g.createRange,s,p,z,D,b=a('<div class="wangEditor-textarea" ></div>'),x=a('<div class="wangEditor-btn-container"></div>'),y=a('<div class="wangEditor-mask"></div>'),K=a("<div></div>"),C,N,k=[],n=-1,O="wangeditor_"+Math.random().toString().replace(".","")+"_",P=1;t.wangEditor_getUniqeId||(t.wangEditor_getUniqeId=h);E="\u5b8b\u4f53;\u9ed1\u4f53;\u6977\u4f53;\u96b6\u4e66;\u5e7c\u5706;\u5fae\u8f6f\u96c5\u9ed1;Arial;Verdana;Georgia;Times New Roman;Trebuchet MS;Courier New;Impact;Comic Sans MS".split(";");
w={"#880000":"\u6697\u7ea2\u8272","#800080":"\u7d2b\u8272","#ff0000":"\u7ea2\u8272","#ff00ff":"\u9c9c\u7c89\u8272","#000080":"\u6df1\u84dd\u8272","#0000ff":"\u84dd\u8272","#00ffff":"\u6e56\u84dd\u8272","#008080":"\u84dd\u7eff\u8272","#008000":"\u7eff\u8272","#808000":"\u6a44\u6984\u8272","#00ff00":"\u6d45\u7eff\u8272","#ffcc00":"\u6a59\u9ec4\u8272","#808080":"\u7070\u8272","#c0c0c0":"\u94f6\u8272","#000000":"\u9ed1\u8272"};F={1:"10px",2:"13px",3:"16px",4:"19px",5:"22px",6:"25px",7:"28px"};D="fontFamily fontSize | bold underline italic | foreColor backgroundColor removeFormat | unOrderedList orderedList | justifyLeft justifyCenter justifyRight | createLink unLink | insertHr insertTable webImage | undo redo".split(" ");
z={fontFamily:{title:"\u5b57\u4f53",type:"dropMenu",txt:"fa fa-font",command:"fontName ",dropMenu:function(){var c=[];a.each(E,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="font-family:${family};">${txt}</a></li>'.replace("${value}",d).replace("${family}",d).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},fontSize:{title:"\u5b57\u53f7",type:"dropMenu",txt:"fa fa-text-height",command:"fontSize",dropMenu:function(){var c=[];a.each(F,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="font-size:${fontsize};">${txt}</a></li>'.replace("${value}",
a).replace("${fontsize}",d).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},bold:{title:"\u52a0\u7c97",type:"btn",hotKey:"ctrl + b",txt:"fa fa-bold",command:"bold",callback:function(){}},underline:{title:"\u4e0b\u5212\u7ebf",type:"btn",hotKey:"ctrl + u",txt:"fa fa-underline",command:"underline "},italic:{title:"\u659c\u4f53",type:"btn",hotKey:"ctrl + i",txt:"fa fa-italic",command:"italic "},foreColor:{title:"\u524d\u666f\u8272",type:"dropMenu",txt:"fa fa-pencil|color:#4a7db1",command:"foreColor ",
dropMenu:function(){var c=[];a.each(w,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="color:${color};">${txt}</a></li>'.replace("${value}",a).replace("${color}",a).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},backgroundColor:{title:"\u80cc\u666f\u8272",type:"dropMenu",txt:"fa fa-paint-brush|color:Red",command:"backColor ",dropMenu:function(){var c=[];a.each(w,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="background-color:${color};color:#ffffff;">${txt}</a></li>'.replace("${value}",
a).replace("${color}",a).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},removeFormat:{title:"\u6e05\u9664\u683c\u5f0f",type:"btn",txt:"fa fa-eraser",command:"RemoveFormat "},unOrderedList:{title:"\u65e0\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ul",command:"InsertUnorderedList "},orderedList:{title:"\u6709\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ol",command:"InsertOrderedList "},justifyLeft:{title:"\u5de6\u5bf9\u9f50",type:"btn",txt:"fa fa-align-left",command:"JustifyLeft "},
justifyCenter:{title:"\u5c45\u4e2d",type:"btn",txt:"fa fa-align-center",command:"JustifyCenter"},justifyRight:{title:"\u53f3\u5bf9\u9f50",type:"btn",txt:"fa fa-align-right",command:"JustifyRight "},createLink:{title:"\u63d2\u5165\u94fe\u63a5",type:"modal-small",txt:"fa fa-link",modal:function(){var c=h(),l=h(),d=h(),b=h();$modal=a('<div>   \u94fe\u63a5\uff1a<input id="'+c+'" type="text" style="width:300px;"/><br />   \u6807\u9898\uff1a<input id="'+l+'" type="text" style="width:300px;"/><br />   \u65b0\u7a97\u53e3\uff1a<input id="'+
d+'" type="checkbox" checked="checked"/><br />   <button id="'+b+'" type="button" class="wangEditor-modal-btn">\u63d2\u5165\u94fe\u63a5</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+b).click(function(f){var e=a.trim($modal.find("#"+c).val()),b=a.trim($modal.find("#"+l).val()),r=$modal.find("#"+d).is(":checked");e||(e=a.trim(g.getElementById(c).value),b=a.trim(g.getElementById(l).value));""!==e&&(!1===M(e)?alert("\u60a8\u7684\u8f93\u5165\u5185\u5bb9\u6709\u4e0d\u5b89\u5168\u5b57\u7b26\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\uff01"):
""!==b||r?v(f,"customCreateLink",{url:e,title:b,isBlank:r},callback):v(f,"createLink",e,callback))});return $modal}()},unLink:{title:"\u53d6\u6d88\u94fe\u63a5",type:"btn",txt:"fa fa-unlink",command:"unLink "},insertHr:{title:"\u63d2\u5165\u6a2a\u7ebf",type:"btn",txt:"fa fa-minus",command:"InsertHorizontalRule "},insertTable:{title:"\u63d2\u5165\u8868\u683c",type:"modal-small",txt:"fa fa-table",modal:function(){var c=h(),l=h(),d=h(),b=h(),f=a('<div>   \u884c\u6570\uff1a<input id="'+c+'" type="text" style="width:30px;"/>   \u5217\u6570\uff1a<input id="'+
l+'" type="text"  style="width:30px;"/>   \u663e\u793a\u6807\u9898\u884c\uff1a<input id="'+d+'" type="checkbox" checked="checked"/>   &nbsp;&nbsp;&nbsp;&nbsp;   <button id="'+b+'" class="wangEditor-modal-btn">\u63d2\u5165\u8868\u683c</button>',"</div>"),e=function(){f.find("input").val("")};f.find("#"+b).click(function(a){var b=f.find("#"+c).val(),b=""===b||isNaN(+b)?3:b,m=f.find("#"+l).val(),m=""===m||isNaN(+m)?5:m,r=f.find("#"+d).is(":checked"),g,h;g="";var n=[],p=[];for(g=0;g<b;g++){p=[];for(h=
0;h<m;h++)p.push('<td style="width:100px;">&nbsp;</td>');0===g&&r?n.push('<tr style="font-weight:bold;background-color:#f1f1f1;">${content}</tr>'.replace("${content}",p.join(""))):n.push("<tr>${content}</tr>".replace("${content}",p.join("")))}g='<table border="1" bordercolor="#cccccc" cellpadding="0" cellspacing="0" style="border-collapse:collapse;" > ${content} </table>'.replace("${content}",n.join(""));v(a,"insertHTML",g,e)});return f}()},webImage:{title:"\u7f51\u7edc\u56fe\u7247",type:"modal-small",
txt:"fa fa-image",modal:function(){var c=h(),l=h(),d=h();$modal=a('<div>   \u7f51\u5740\uff1a<input id="'+c+'" type="text" style="width:300px;"/><br/>   \u6807\u9898\uff1a<input id="'+l+'" type="text" style="width:300px;"/><br/>   <button id="'+d+'" type="button" class="wangEditor-modal-btn">\u63d2\u5165\u56fe\u7247</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+d).click(function(d){var b=a.trim($modal.find("#"+c).val()),e=a.trim($modal.find("#"+l).val());b||(b=
a.trim(g.getElementById(c).value),e=a.trim(g.getElementById(e).value));""!==b&&(!1===M(b)?alert("\u60a8\u7684\u8f93\u5165\u5185\u5bb9\u6709\u4e0d\u5b89\u5168\u5b57\u7b26\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\uff01"):""===e?v(d,"insertImage",b,callback):v(d,"customeInsertImage",{url:b,title:e},callback))});return $modal}()},undo:{title:"\u64a4\u9500",type:"btn",hotKey:"ctrl+z",txt:"fa fa-undo",command:function(a){0<n&&(n-=1,b.html(k[n]));a.preventDefault()}},redo:{title:"\u91cd\u590d",type:"btn",txt:"fa fa-repeat",
command:function(a){n<k.length-1&&(n+=1,b.html(k[n]));a.preventDefault()}}};N={insertHTML:function(c,b){var d;s&&(d=L(a(p)),0===d.next().length&&(b+="<p>&nbsp;</p>"),d.after(a(b)))},customCreateLink:function(c,b){for(var d=b.url,r=b.title,f,e=h(),n;1!==p.nodeType;)p=p.parentNode;f=a(p);n=f.find("a");0<n.length&&n.attr(e,"1");g.execCommand("createLink",!1,d);d=f.find("a").not("["+e+"]");d.attr("title",r);d.attr("target","_blank");0<n.length&&n.removeAttr(e)},customeInsertImage:function(c,b){for(var d=
b.url,n=b.title,f,e=h(),k;1!==p.nodeType;)p=p.parentNode;f=a(p);k=f.find("img");0<k.length&&k.attr(e,"1");g.execCommand("insertImage",!1,d);d=f.find("img").not("["+e+"]");d.attr("title",n);d.attr("alt",n);0<k.length&&k.removeAttr(e)},delete$elem:function(a,b){b.remove()}};t.wangeditor_commonCommand||(t.wangeditor_commonCommand=v);Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0,d=this.length;b<d;b++)if(this[b]===a)return b;return-1},Array.prototype.lastIndexOf=function(a){for(var b=
this.length,b=b-1;0<=b;b--)if(this[b]===a)return b;return-1});a.fn.wangEditor=function(c){function n(c){if("|"===c.toString())return a('<div class="wangEditor-btn-container-split"></div>');var d=c.type,e=c.txt,g=c.title,f=c.command,h=c.hotKey,m=[],p,l=c.dropMenu,k=c.modal,r=c.callback,q=a('<a class="wangEditor-btn-container-btn wangEditor-btn-container-btn-default" href="#"></a>');"string"===typeof f&&(f=a.trim(f));-1!==e.indexOf("|")?(c=e.split("|"),e='<i class="'+c[0]+'" style="'+c[1]+'"></i>'):
e='<i class="'+e+'"></i>';q.html(e);g&&q.attr("title",g);if("btn"===d){if("string"===typeof f&&q.attr("commandName",f),"string"===typeof f&&q.click(function(a){v(a,f,void 0,r)}),"function"===typeof f&&q.click(function(a){f(a)}),h){var s=function(c){var b=!0;a.each(["ctrl","shift","alt","meta"],function(a,d){-1===m.indexOf(d)||c[d+"Key"]?-1===m.indexOf(d)&&c[d+"Key"]&&(b=!1):b=!1});return b},h=h.toLowerCase();p=a.trim(h.split("+")[1]);m=h.split("+")[0].split(",");a.each(m,function(c,b){m[c]=a.trim(b)});
b.on("keydown",function(a){!1!==s(a)&&String.fromCharCode(a.keyCode).toLowerCase()===p&&(a.preventDefault(),q.click())})}}else if("dropMenu"===d){var t=function(){l.hide()};q.append(a('<i class="fa fa-angle-down"></i>'));l.attr("class","wangEditor-drop-menu");C.append(l);q.click(function(a){var c=q.position().top,b=q.position().left,d=q.height();l.css({top:c+d+5+"px",left:b+"px"});l.show();a.preventDefault();this.focus()}).blur(function(a){setTimeout(t,100)});l.on("click","a[commandValue]",function(c){var b=
a(this).attr("commandValue");v(c,f,b)});l.hide()}else 0===d.indexOf("modal")&&("modal"===d&&(d=""),k.attr("class","wangEditor-modal wangEditor-"+d),k.prepend(a('<div class="wangEditor-modal-header"><a href="#" commandName="close" class="wangEditor-modal-header-close"><i class="fa fa-close"></i></a><b>'+g+'</b><div class="wangEditor-clear-both"></div><div class="wangEditor-modal-header-line"></div></div>')),K.append(k),q.click(function(a){var c=F.width(),b=F.height(),d=k.width(),e=x.position().top,
f=x.height();y.width(c);y.height(b);k.css({top:e+f+"px",left:(c-d)/2+"px"});y.show();k.show();a.preventDefault()}),k.find("[commandName=close]").click(function(a){y.hide();k.hide();a.preventDefault()}));if(g){var u=function(){A.show()};q.attr("title","");h&&(g=g+"("+h+")");var w,z,B,A=a('<div class="wangEditor-toolTip"></div>'),d=a('<div class="wangEditor-toolTip-content">'+g+"</div>"),g=a('<div class="wangEditor-toolTip-footer"><i class="fa fa-caret-down"></i></div>'),D,G,H,I,J;A.append(d).append(g);
E.append(A);q.mouseenter(function(){w=q.position().top;z=q.position().left;B=q.width();D=A.height();G=A.width();H=w-D+5;I=z-(G-B)/2+3;A.css({top:H+"px",left:I+"px"});J=setTimeout(u,200)}).mouseleave(function(){clearTimeout(J);A.hide()})}return q}function d(a){s=H();G();a&&"focus"===a.type&&b.off("focus",d)}function g(){B&&(u.hide(),B=!1)}c=c||{};var f=c.customMenus,e=c.insertBefore,h=c.after,k=c.hideMenuConfig,m,p=this.height(),w=this.html(),C=a("<div></div>"),E=a("<div></div>"),F=a(t),u=a('<a href="#" class="wangEditor-tableDeleteBtn"><i class="fa fa-close"></i></a>'),
B;f&&(a.each(f,function(a){D.push(a)}),z=a.extend(z,f));c.menuConfig?m=c.menuConfig:(m=D,e&&a.each(e,function(c,b){var d=m.indexOf(a.trim(c));-1!==d&&("string"===typeof b&&(b=[b]),a.each(b,function(c,b){b=a.trim(b);if("|"!==b){var d=m.lastIndexOf(b);-1!==d&&(m[d]=null)}}),b.unshift(0),b.unshift(d),Array.prototype.splice.apply(m,b))}),h&&a.each(h,function(b,c){var d=m.indexOf(a.trim(b));"string"===typeof c&&(c=[c]);a.each(c,function(c,b){b=a.trim(b);if("|"!==b){var d=m.lastIndexOf(a.trim(b));-1!==
d&&(m[d]=null)}});d+1===m.length?Array.prototype.push.apply(m,c):(c.unshift(0),c.unshift(d+1),Array.prototype.splice.apply(m,c))}),k&&a.each(k,function(){var b=a.trim(this),b=m.indexOf(b);-1!==b&&(m[b]=null)}));a.each(m,function(){if(null!=this){var b=a.trim(this);if(b="|"===b?"|":z[b])b=n(b),x.append(b)}});x.append(a('<div class="wangEditor-clear-both"></div>')).append(a('<div class="wangEditor-btn-container-line"></div>'));b.on("focus",d).on("mousedown",function(){b.on("mouseleave",function(){b.off("mouseleave");
setTimeout(d,100)})}).on("click keyup",function(a){var c=!1,c=[33,34,35,36,37,38,39,40,13,8,46,9];if(c="click"===a.type||"keyup"===a.type&&-1!==c.indexOf(a.keyCode)||a.ctrlKey||a.shiftKey)d(),"click"===a.type&&b.off("mouseleave")}).on("focus blur",function(){J()});B=!1;b.on("click","table,img",function(){var c=a(this),d=b.position().top,e=c.position().top,f=c.position().left,h=u.width(),k=u.height();e<=d||(u.css({top:e-k/2+"px",left:f-h/2+"px"}),u.show(),B=!0,b.off("scroll"),b.on("scroll",g),u.off(),
u.click(function(a){v(a,"delete$elem",c,g)}))});b.on("keyup blur",function(){setTimeout(g,100)});this.attr("class","wangEditor");this.html("").append(u).append(E).append(y).append(C).append(K).append(x).append(b);b.html(w);p=p-x.height()-12;b.height(50<=p?p:100);Q();b.attr("contenteditable",!0);return b}}})(window);